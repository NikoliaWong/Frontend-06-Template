<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用状态机实现</title>
</head>

<body>
    <script>
        // 用状态机实现：字符串“abcabx”的解析
        {
            function match(string) {
                let state = start;
                for (let c of string) {
                    state = state(c);
                }
                return state === end;
            }

            function start(c) {
                if (c === 'a')
                    return foundA;
                else
                    return start;
            }

            function end(c) {
                return end;
            }

            function foundA(c) {
                if (c === 'b')
                    return foundB;
                else
                    return start(c);
            }

            function foundB(c) {
                if (c === 'c')
                    return foundC;
                else
                    return start(c);
            }

            function foundC(c) {
                if (c === 'a')
                    return foundA2;
                else
                    return start(c);
            }

            function foundA2(c) {
                if (c === 'b')
                    return foundB2;
                else
                    return start(c);
            }

            function foundB2(c) {
                if (c === 'x')
                    return end;
                else
                    return foundB(c);
            }

            console.log(match('aaabcabxcx'))


        }
        // 使用状态机完成”abababx”的处理
        {
            function match(string) {
                let state = start;
                for (let c of string) {
                    state = state(c);
                }
                return state === end;
            }

            function start(c) {
                if (c === 'a')
                    return foundA;
                else
                    return start;
            }

            function end(c) {
                return end;
            }

            function foundA(c) {
                if (c === 'b')
                    return foundB;
                else
                    return start(c);
            }

            function foundB(c) {
                if (c === 'a')
                    return foundA2;
                else
                    return start(c);
            }


            function foundA2(c) {
                if (c === 'b')
                    return foundB2;
                else
                    return start(c);
            }

            function foundB2(c) {
                if (c === 'a')
                    return foundA3;
                else
                    return start(c);
            }

            function foundA3(c) {
                if (c === 'b')
                    return foundB3;
                else
                    return start(c);
            }

            function foundB3(c) {
                if (c === 'x')
                    return end;
                else
                    return foundB2(c);
            }

            console.log(match('aaabababababababxababxx'))
        }
        //可选作业：我们如何用状态机处理完全未知的 pattern？ （参考资料：字符串 KMP 算法 https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm）
        
    </script>
</body>

</html>